## 為什麼建議透過第三方服務寄送 Email

使用第三方服務可進一步提升送達率與監控能力，同時減少主 Backend 的負擔，專注於核心業務邏輯

## 驗證碼發送流程

1. 使用者請求驗證碼（用於註冊、重設密碼）
2. 後端生成一次性驗證碼
3. 驗證碼存入暫存資料庫（Redis）並設定 TTL
4. 透過 SMTP 或第三方郵件 API 發送
5. 使用者輸入驗證碼，給後端驗證

## 重試策略

舉例：每個 IP 和 裝置綁定在一起，每分鐘限制發送次數，雖然請求可以被偽造，但避免用戶濫用也要防止好人被誤殺。 或以其他多種來源的組合，可以顯著提高攻擊者的偽造成本，從而降低大規模濫用的可行性。
最好能根據使用者行為動態調整限制，並提供適當的錯誤訊息引導使用者。

## 模板設計

- 動態參數：如驗證碼、使用者名稱、連結、安全資訊
- 版本管理：模板更新需可回溯，避免破壞舊流程
- 一致性：品牌識別、排版統一，提升使用者體驗

## 使用個人網域

到目前幾乎沒有免費的網域可以用來發送郵件，為了順利發送郵件，使用個人網域是必要的選擇。
雖然有成本，但能提升專業形象和信任度，對於實際專案來說是值得的投資。
還有一點是不能用自己的 Gmail 來發送大量重複內容的郵件，因為 Gmail 會認為是垃圾郵件，甚至可能導致帳號被封鎖。

## 環境變數

- 防止敏感資訊洩漏，直接在程式碼中硬編碼密碼是非常危險的行為
- 本地使用環境變數（如 .env 文件）來存儲 SMTP 密碼和其他敏感資訊，且在`.gitignore`中排除
- 在生產環境雲平台中，使用 Environment Variables 功能來管理敏感資訊，確保安全性與可維護性

## 結論

第三方服務本質上不可靠，系統設計必須以「會失敗」為前提。假設 Email 郵寄失敗，
透過降級、非同步處理與替代方案，將第三方故障與核心服務隔離；
再配合監控與日誌，確保問題可被快速察覺並修復，而不影響整體使用者體驗。

## 外部專案

[email-send-backend 儲存庫](https://github.com/LingoNext/email-send-backend)
